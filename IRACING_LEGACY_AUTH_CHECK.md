# 레거시 인증 활성화 확인 가이드

## ⚠️ 중요: 레거시 인증이 활성화되어 있어도 인증이 실패할 수 있습니다

레거시 인증을 활성화했다고 해서 바로 작동하는 것은 아닙니다. 다음을 확인하세요:

## 1단계: 레거시 인증 상태 확인

### 방법 1: 계정 관리 페이지에서 확인

1. **iRacing 계정 관리 페이지 접속**
   ```
   https://oauth.iracing.com/accountmanagement/
   ```

2. **Security 섹션 찾기**
   - 페이지를 스크롤하여 "Security" 섹션 찾기
   - 또는 브라우저 검색 기능(Ctrl+F)으로 "Legacy" 검색

3. **레거시 인증 상태 확인**
   - "Legacy Authentication" 또는 "Legacy Read-Only Authentication" 섹션 찾기
   - 현재 상태 확인:
     - ✅ **"Enabled"** 또는 **"활성화됨"** → 정상
     - ❌ **"Disabled"** 또는 **"비활성화됨"** → 활성화 필요

4. **활성화 방법**
   - "Enable Legacy Authentication" 버튼 클릭
   - 확인 대화상자에서 "Confirm" 또는 "확인" 클릭
   - 페이지 새로고침하여 상태가 "Enabled"로 변경되었는지 확인

### 방법 2: 브라우저 개발자 도구로 확인

1. **계정 관리 페이지에서 F12 눌러 개발자 도구 열기**
2. **Network 탭 열기**
3. **페이지 새로고침 (F5)**
4. **API 요청 확인**
   - `accountmanagement` 관련 요청 찾기
   - Response에서 `legacyAuth` 또는 `legacy_authentication` 필드 확인

## 2단계: 레거시 인증 활성화 후 확인 사항

### ✅ 활성화 후 필수 확인

1. **페이지 새로고침**
   - 레거시 인증을 활성화한 후 페이지를 새로고침
   - 상태가 "Enabled"로 표시되는지 확인

2. **서버 재시작**
   ```bash
   # 개발 서버 중지 (Ctrl+C)
   npm run dev
   ```

3. **몇 분 대기**
   - 일부 경우 변경 사항이 적용되는데 시간이 걸릴 수 있음
   - 최대 5-10분 대기 후 재시도

4. **디버그 엔드포인트 재확인**
   ```
   http://localhost:3000/api/iracing/debug
   ```

## 3단계: 여전히 실패하는 경우

### 가능한 원인들

1. **레거시 인증이 실제로 활성화되지 않음**
   - 버튼을 클릭했지만 실제로 활성화되지 않았을 수 있음
   - 페이지를 새로고침하여 다시 확인

2. **비밀번호 문제**
   - 비밀번호가 정확하지 않음
   - 대소문자 구분 확인
   - 특수문자 인코딩 문제

3. **계정 상태 문제**
   - 계정이 비활성화됨
   - 구독이 만료됨
   - 계정이 정지됨

4. **2FA 문제**
   - 2FA가 활성화되어 있지만 레거시 인증이 제대로 활성화되지 않음
   - 레거시 인증을 다시 활성화 시도

### 추가 확인 사항

1. **iRacing 웹사이트 직접 로그인 테스트**
   ```
   https://members.iracing.com
   ```
   - 동일한 이메일/비밀번호로 로그인 시도
   - 로그인 성공 여부 확인

2. **비밀번호 재설정 고려**
   - 비밀번호에 특수문자가 많으면 문제가 될 수 있음
   - 간단한 비밀번호로 변경 후 테스트

3. **iRacing 지원팀 문의**
   - 위의 모든 방법을 시도했는데도 실패하면
   - https://support.iracing.com 에서 문의
   - 레거시 인증 활성화 후에도 API 접근이 안 된다고 설명

## 4단계: 임시 해결책

개발/테스트 목적으로 Mock 모드를 사용할 수 있습니다:

```env
IRACING_MOCK=true
```

이렇게 하면 실제 API 대신 Mock 데이터를 사용합니다.

## 체크리스트

- [ ] 레거시 인증이 "Enabled" 상태인지 확인
- [ ] 레거시 인증 활성화 후 페이지 새로고침
- [ ] 서버 재시작 (Ctrl+C 후 npm run dev)
- [ ] iRacing 웹사이트에서 직접 로그인 성공 확인
- [ ] 비밀번호가 정확한지 확인 (대소문자, 특수문자)
- [ ] 계정이 활성화되어 있고 구독이 만료되지 않았는지 확인
- [ ] 레거시 인증 활성화 후 5-10분 대기
- [ ] 디버그 엔드포인트로 재확인

모든 항목을 확인했는데도 실패하면 iRacing 지원팀에 문의하세요.

